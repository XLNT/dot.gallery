scalar DateTime
scalar Json

type Entity {
  id: ID!
  handle: String
  email: String!

  assets: [Asset!]!
  counterfactualTokens: [CounterfactualToken!]!
  placements: [Placement!]!
  tickets: [Ticket!]!

  createdAt: DateTime!
  updatedAt: DateTime!
}

type Asset {
  id: ID!
  uri: String!

  owner: Entity!

  createdAt: DateTime!
  updatedAt: DateTime!
}

type CounterfactualToken {
  id: ID!
  tokenURI: String!

  owner: Entity!
  placement: Placement!

  createdAt: DateTime!
  updatedAt: DateTime!
}

type Ticket {
  id: ID!

  exhibition: Exhibition!

  createdAt: DateTime!
  updatedAt: DateTime!
}


type Exhibition {
  id: ID!
  title: String!
  number: Int!
  theme: Json
  extent: Int!

  shows: [Show!]
  rooms: [Room!]

  createdAt: DateTime!
  updatedAt: DateTime!

  # custom
  ticketsAvailable: Int!
  currentTicketPrice: Int!
}

type Show {
  id: ID!
  number: Int!
  opensAt: DateTime!
  closesAt: DateTime!

  exhibition: Exhibition!

  createdAt: DateTime!
  updatedAt: DateTime!
}

type Room {
  id: ID!
  entryId: ID!
  x: Int!
  y: Int!

  exhibition: Exhibition!
  placements: [Placement!]!
}

type Placement {
  id: ID!
  x: Int!
  y: Int!

  entity: Entity!
  room: Room!
  counterfactualToken: CounterfactualToken!

  createdAt: DateTime!
}

type Query {
  currentEntity: Entity!
  currentExhibition: Exhibition
  entity(id: ID!): Entity!
}

type Mutation  {
  loginAs(accessToken: String!): String!
  placeAsset(assetId: ID!, roomId: ID!, x: Int!, y: Int!): Placement
  createEntity: Entity!
  createAsset(ownerId: ID!, uri: String!): Asset!

  modIssueTicket(exhibitionId: ID!, email: String, id: String): Ticket
}
