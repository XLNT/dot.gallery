enum Rarity {
  COMMON
  RARE
}

type Entity {
  id: ID! @id
  handle: String! @unique
  email: String! @unique

  # entity has_many createdIssues
  createdIssues: [Issue!]! @relation(name: "CreatedIssues")
  # entity has_many ownedAssets
  ownedAssets: [Asset!]! @relation(name: "OwnedAssets")
  # entity has_many printedAssets
  printedAssets: [Asset!]! @relation(name: "PrintedAssets")

  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Issue {
  id: ID! @id

  uri: String!
  rarity: Rarity! @default(value: COMMON)
  emojis: [String!]! @scalarList(strategy: RELATION)

  # issue has_one creator
  creator: Entity! @relation(name: "CreatedIssues")
  # issue has_many assets
  assets: [Asset!]!

  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Asset {
  id: ID! @id

  # uri: String
  isCounterfactual: Boolean! @default(value: false)

  # asset belongs_to: owner
  owner: Entity! @relation(name: "OwnedAssets")
  # asset belongs_to: issue
  issue: Issue!
  # asset belongs_to: printer
  printer: Entity! @relation(name: "PrintedAssets")

  rooms: [Room!]! @relation(name: "AssetRooms")

  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Exhibition {
  id: ID! @id
  number: Int! @unique
  theme: Json
  extent: Int! @default(value: 7)
  opensAt: DateTime!
  closesAt: DateTime!

  shows: [Show!]!
  rooms: [Room!]! @relation(name: "ExhibitionRooms")

  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Show {
  id: ID! @id
  number: Int!
  opensAt: DateTime!
  closesAt: DateTime!

  exhibition: Exhibition!

  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Room {
  id: ID! @id
  entryId: ID! @unique

  x: Int!
  y: Int!

  exhibition: Exhibition! @relation(name: "ExhibitionRooms")
  assets: [Asset!]! @relation(name: "AssetRooms", link: TABLE)
}
